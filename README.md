# Бот с платной подпиской через API Точка

## Основная логика
- Пользователь получает ссылку на оплату подписки.
- После оплаты по API Точка приходит вебхук, подписка продлевается на 30 дней.
- После оплаты бот отправляет ссылку на вступление в группу.
- За 5 дней до окончания подписки бот напоминает оплатить.
- Если подписка закончилась — пользователь удаляется из группы.

## Cron/Management commands
- Для напоминаний и автокика используйте management commands (см. management/commands/remind_subs.py и ban_expired.py).

## Настройка
- Укажите свою ссылку на вступление в INVITE_LINK в handlers/common.py.
- Укажите реальные параметры API Точка для генерации ссылки на оплату.

BOT_TOKEN = 
OWNER_ID =
INVITE_LINK =
HOOK = 
LOCAL = 
TOCHKA_API_TOKEN=
TOCHKA_ACCOUNT_ID = 
TOCHKA_CUSTOMER_CODE =

## Интеграция с API Точка

В `.env` должны быть следующие переменные:

```
TOCHKA_API_TOKEN=ваш_токен_точка
TOCHKA_CUSTOMER_CODE=ваш_customerCode_точка
INVITE_LINK=ваша_ссылка_на_группу
HOOK=ваш_публичный_адрес_бота (например, https://example.com)
```

- `TOCHKA_API_TOKEN` — Bearer-токен для API Точка
- `TOCHKA_CUSTOMER_CODE` — ваш уникальный customerCode (узнайте в личном кабинете Точка)
- `INVITE_LINK` — ссылка на вступление в группу Telegram
- `HOOK` — публичный адрес, на который Точка будет отправлять колбеки (например, https://ваш_домен/bot/tochka_payment_webhook/)

**Важно:**
- Проверьте, что вебхук доступен из интернета (используйте ngrok или реальный сервер)
- После успешной оплаты пользователю автоматически отправится ссылка на вступление в группу